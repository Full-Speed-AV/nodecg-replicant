<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="nodecg-replicant-targeting.html">

<!--
The `nodecg-replicant` element binds to a Replicant. Once bound, the value of the replicant can be retrieved and set
from the `value` property.

    <nodecg-replicant name="myReplicant" bundle="my-bundle"></nodecg-replicant>

This element is useful in cases where instantiating and binding to a replicant in a purely declarative fashion
is desirable. For example, it can be used to create a two-way binding with a `paper-input` element.

    <nodecg-replicant name="myReplicant" value="{{value}}"></nodecg-replicant>
    <paper-input label="myReplicant" value="{{value}}"></paper-input>

@demo demo/index.html
@hero hero.svg
-->

<script>
    'use strict';

    Polymer({

        is: 'nodecg-replicant',

        /**
         * Fired when the value of the target replicant changes.
         *
         * @event change
         */

        hostAttributes: {
            hidden: true
        },

        behaviors: [
            Polymer.NodeCGReplicantTargetingBehavior
        ],

        get value () {
            if (this.replicant) {
                return this.replicant.value;
            }
        },

        set value (newVal) {
            if (this.replicant) {
                return this.replicant.value = newVal;
            }
        },

        /**
         * The current value of the target replicant.
         *
         * @return {*}
         */

        _replicantChanged: function(oldVal, newVal, changes) {
            this.fire('value-changed', {
                value: newVal
            }, {bubbles: false});
            this.fire('change', {
                oldVal: oldVal,
                newVal: newVal,
                changes: changes
            }, {bubbles: false})
        }

    });
</script>